# 正向代理与反向代理【总结】

## **正向代理**

　　正向代理类似一个跳板机，代理访问外部资源。

![img](F:\NoteBook\TyporaPic\305504-20161112124853014-1532060796.png)

**客户端必须设置正向代理服务器，当然前提是要知道正向代理服务器的IP地址，还有代理程序的端口。**

总结来说：正向代理 是一个位于客户端和原始服务器(origin server)之间的服务器，为了从原始服务器取得内容，客户端向代理发送一个请求并指定目标(原始服务器)，然后代理向原始服务器转交请求并将获得的内容返回给客户端。客户端必须要进行一些特别的设置才能使用正向代理。

### **正向代理的用途**

* 访问原来无法访问的资源，如google

* 可以做缓存，加速访问资源

* 对客户端访问授权，上网进行认证

* 代理可以记录用户访问记录（上网行为管理），对外隐藏用户信息

例如CCProxy用途：

![img](F:\NoteBook\TyporaPic\305504-20161112120952686-765920985.png)

## 反向代理

　　初次接触方向代理的感觉是，客户端是无感知代理的存在的，反向代理对外都是透明的，访问者者并不知道自己访问的是一个代理。因为客户端不需要任何配置就可以访问。

　　反向代理（Reverse Proxy）实际运行方式是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个服务器。

### 反向代理的作用

* 保证内网的安全，可以使用反向代理提供WAF功能，阻止web攻击

大型网站，通常将反向代理作为公网访问地址，Web服务器是内网。

> 反向代理服务器可以作为应用层防火墙，为网站提供对基于Web的攻击行为（例如DoS/DDoS）的防护，更容易排查恶意软件等。还可以为后端服务器统一提供加密和SSL加速（如SSL终端代理），提供HTTP访问认证等。

* 负载均衡，通过反向代理服务器来优化网站的负载

* 可以做缓存，提高访问速度

### 正向代理和反向代理的区别

借用知乎张图来表达：https://www.zhihu.com/question/24723688

![img](F:\NoteBook\TyporaPic\305504-20161112130135639-1005446770.png)

**正向代理和反向代理的区别**

虽然正向代理服务器和反向代理服务器所处的位置都是客户端和真实服务器之间，所做的事情也都是把客户端的请求转发给服务器，再把服务器的响应转发给客户端，但是二者之间还是有一定的差异的。

1、**正向代理其实是客户端的代理**，帮助客户端访问其无法访问的服务器资源。**反向代理则是服务器的代理**，帮助服务器做负载均衡，安全防护等。

2、**正向代理一般是客户端架设的**，比如在自己的机器上安装一个代理软件。而**反向代理一般是服务器架设的**，比如在自己的机器集群中部署一个反向代理服务器。

3、**正向代理中，服务器不知道真正的客户端到底是谁**，以为访问自己的就是真实的客户端。而在**反向代理中，客户端不知道真正的服务器是谁**，以为自己访问的就是真实的客户端。

4、正向代理和反向代理的作用和目的不同。**正向代理主要是用来解决访问限制问题。而反向代理则是提供负载均衡、安全防护等作用。二者均能提高访问速度。**





## nginx的反向代理

 　nginx支持配置反向代理，通过反向代理实现网站的负载均衡。这部分先写一个nginx的配置，后续需要深入研究nginx的代理模块和负载均衡模块。

nginx通过proxy_pass_http 配置代理站点，upstream实现负载均衡。

![img](F:\NoteBook\TyporaPic\305504-20161112125220561-594431822.png)

## 参考

https://www.cnblogs.com/anker/p/6056540.html

https://juejin.im/post/6844903782556368910